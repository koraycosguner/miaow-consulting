<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Price Optimizer | Revenue vs. Profit</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #990000; /* IU Crimson */
            --revenue-color: #2563eb; /* Blue for Revenue */
            --profit-color: #990000; /* Crimson for Profit */
            --gap-color: #ef4444; /* Bright Red for the 'Gap' point */
            --text-main: #111827;
            --text-light: #4b5563;
            --bg: #f9fafb;
            --surface: #ffffff;
            --border: #e5e7eb;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: var(--bg);
            color: var(--text-main);
            margin: 0;
            padding: 40px 20px;
            line-height: 1.6;
        }

        .container { max-width: 1100px; margin: 0 auto; }

        .header { text-align: center; margin-bottom: 40px; }
        .header h1 { font-size: 2rem; font-weight: 800; margin: 0 0 10px 0; letter-spacing: -0.02em; }
        .header p { color: var(--text-light); font-size: 1.1rem; max-width: 600px; margin: 0 auto; }

        .model-note {
            background: #fdf2f2;
            border-left: 4px solid var(--primary);
            padding: 15px;
            border-radius: 8px;
            margin: 20px auto 40px auto;
            max-width: 800px;
            font-size: 0.95rem;
            color: var(--text-light);
        }

        .grid-layout {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 30px;
            align-items: start;
        }

        /* Input Sidebar */
        .sidebar {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.02);
        }

        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; font-size: 0.9rem; font-weight: 600; margin-bottom: 8px; color: var(--text-main); }
        .input-group input {
            width: 100%; padding: 10px 12px; border: 1px solid var(--border); border-radius: 6px; font-size: 1rem; box-sizing: border-box; 
        }
        .input-hint { font-size: 0.8rem; color: var(--text-light); margin-top: 4px; }

        .btn-calc {
            background: var(--text-main); color: white; border: none; padding: 14px 28px; border-radius: 8px; font-size: 1rem; font-weight: 700;
            cursor: pointer; width: 100%; transition: background 0.2s; margin-top: 10px;
        }
        .btn-calc:hover { background: black; }

        /* Results Area */
        .results-area { display: none; animation: fadeIn 0.5s ease-out; }

        /* Comparison Grid */
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .result-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .card-revenue { border-top: 4px solid var(--revenue-color); }
        .card-profit { border-top: 4px solid var(--profit-color); background: #fffcfc; }

        .card-title { font-size: 1rem; font-weight: 800; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 20px; display: block; }
        .card-revenue .card-title { color: var(--revenue-color); }
        .card-profit .card-title { color: var(--profit-color); }

        .metric-row { display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 0.95rem; border-bottom: 1px solid #f3f4f6; padding-bottom: 8px; }
        .metric-row:last-child { border-bottom: none; }
        .metric-label { color: var(--text-light); }
        .metric-val { font-weight: 700; color: var(--text-main); }
        
        .highlight-val { font-size: 1.4rem; font-weight: 800; display: block; margin-top: 10px; }
        .card-revenue .highlight-val { color: var(--revenue-color); }
        .card-profit .highlight-val { color: var(--profit-color); }

        /* Chart */
        .chart-container {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            height: 500px;
            position: relative;
        }

        .footer {
            margin-top: 60px; text-align: center; font-size: 0.85rem; color: #9ca3af; border-top: 1px solid var(--border); padding-top: 20px;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        @media (max-width: 900px) { 
            .grid-layout { grid-template-columns: 1fr; } 
            .comparison-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
<!-- Auth check -->
<div id="loading-screen" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: white; display: flex; align-items: center; justify-content: center; z-index: 9999;">
    <p style="color: #64748b;">Loading...</p>
</div>
<div id="main-content" style="display: none;">

<div style="max-width: 1100px; margin: 0 auto; padding: 20px 20px 20px;">
    <a href="tools.html" style="display: inline-flex; align-items: center; gap: 6px; color: #64748b; text-decoration: none; font-size: 0.9rem; font-weight: 500;">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
        Back to Pricing & Analytics Tools
    </a>
</div>

<div class="container">
    
    <div class="header">
        <h1>Price Optimizer: Revenue vs. Profit</h1>
        <p>Analyze the trade-offs between maximizing <strong>Top-Line Revenue</strong> and maximizing <strong>Bottom-Line Profit</strong>.</p>
        
        <div class="model-note">
            <strong>Model Assumption:</strong> We assume a linear and negative relationship between Demand (<i>Q</i>) and Price (<i>P</i>).
            <br>
            Formula: <em>Q = A + B Ã— P</em> (where <i>B</i> is negative).
            <br>
            This implies that as price increases, demand decreases at a constant rate.
        </div>
    </div>

    <div class="grid-layout">
        
        <div class="sidebar">
            <h3 style="margin-top:0;">Parameters</h3>
            
            <div class="input-group">
                <label>Intercept (A)</label>
                <input type="number" id="val-a" placeholder="e.g. 1000">
                <div class="input-hint">Base demand when Price is 0.</div>
            </div>

            <div class="input-group">
                <label>Slope (B)</label>
                <input type="number" id="val-b" placeholder="e.g. -2.5">
                <div class="input-hint">Must be negative (e.g. -2).</div>
            </div>

            <div class="input-group">
                <label>Variable Cost (C)</label>
                <input type="number" id="val-c" placeholder="e.g. 15.00" step="0.01">
                <div class="input-hint">Cost per unit.</div>
            </div>

            <button class="btn-calc" onclick="optimize()">Run Solver</button>
        </div>

        <div class="results-area" id="results">
            
            <div class="comparison-grid">
                
                <div class="result-card card-revenue">
                    <span class="card-title">Strategy 1: Maximize Revenue</span>
                    
                    <div class="metric-row">
                        <span class="metric-label">Optimal Price</span>
                        <span class="metric-val" id="rev-p">--</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Quantity Sold</span>
                        <span class="metric-val" id="rev-q">--</span>
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <span class="metric-label" style="display:block; font-size:0.8rem;">Resulting Revenue</span>
                        <span class="highlight-val" id="rev-r">--</span>
                    </div>
                    
                    <div style="margin-top: 10px; font-size: 0.9rem; color: #6b7280;">
                        Profit Generated: <span id="rev-profit" style="font-weight:700;">--</span>
                    </div>
                </div>

                <div class="result-card card-profit">
                    <span class="card-title">Strategy 2: Maximize Profit</span>
                    
                    <div class="metric-row">
                        <span class="metric-label">Optimal Price</span>
                        <span class="metric-val" id="prof-p">--</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Quantity Sold</span>
                        <span class="metric-val" id="prof-q">--</span>
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <span class="metric-label" style="display:block; font-size:0.8rem;">Resulting Profit</span>
                        <span class="highlight-val" id="prof-pi">--</span>
                    </div>

                    <div style="margin-top: 10px; font-size: 0.9rem; color: #6b7280;">
                        Revenue Generated: <span id="prof-revenue" style="font-weight:700;">--</span>
                    </div>
                </div>

            </div>

            <div class="chart-container">
                <canvas id="optimizerChart"></canvas>
            </div>
            
            <div style="margin-top: 15px; text-align: center; font-size: 0.9rem; color: var(--text-light);">
                <span style="display:inline-block; width: 10px; height: 10px; background: #2563eb; margin-right: 5px; border-radius: 50%;"></span> Rev Max
                <span style="display:inline-block; width: 10px; height: 10px; background: #990000; margin-left: 15px; margin-right: 5px; border-radius: 50%;"></span> Profit Max
                <span style="display:inline-block; width: 10px; height: 10px; background: transparent; border: 2px solid #ef4444; margin-left: 15px; margin-right: 5px; border-radius: 50%;"></span> Profit Gap
            </div>

        </div>

    </div>

    <div class="footer">
        Created by Dr. Koray Cosguner with the help of Gemini 3.0.
    </div>

</div>

<script>
    let myChart = null;

    function optimize() {
        // 1. Get Inputs
        const A = parseFloat(document.getElementById('val-a').value);
        const B = parseFloat(document.getElementById('val-b').value);
        const C = parseFloat(document.getElementById('val-c').value);

        // Validation
        if (isNaN(A) || isNaN(B) || isNaN(C)) {
            alert("Please provide A, B, and Variable Cost.");
            return;
        }
        if (B >= 0) {
            alert("Slope (B) should be negative (e.g., -2.5).");
            return;
        }

        // --- SOLVER LOGIC ---

        // 1. Revenue Maximization (MR = 0)
        const priceRevMax = -A / (2 * B);
        const qtyRevMax = A + (B * priceRevMax);
        const revMaxTotal = priceRevMax * qtyRevMax;
        const profitAtRevMax = (priceRevMax - C) * qtyRevMax; // This is the 'Gap' point

        // 2. Profit Maximization (MR = MC)
        const priceProfMax = (C - (A/B)) / 2;
        const qtyProfMax = A + (B * priceProfMax);
        const revAtProfMax = priceProfMax * qtyProfMax;
        const profitMaxTotal = (priceProfMax - C) * qtyProfMax;

        // --- UPDATE UI ---
        
        document.getElementById('results').style.display = 'block';
        
        const fmt = (num) => "$" + num.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});
        const fmtNum = (num) => num.toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0});

        // Revenue Card
        document.getElementById('rev-p').innerText = fmt(priceRevMax);
        document.getElementById('rev-q').innerText = fmtNum(qtyRevMax);
        document.getElementById('rev-r').innerText = fmt(revMaxTotal);
        document.getElementById('rev-profit').innerText = fmt(profitAtRevMax);

        // Profit Card
        document.getElementById('prof-p').innerText = fmt(priceProfMax);
        document.getElementById('prof-q').innerText = fmtNum(qtyProfMax);
        document.getElementById('prof-pi').innerText = fmt(profitMaxTotal);
        document.getElementById('prof-revenue').innerText = fmt(revAtProfMax);

        // --- CHARTING ---
        drawChart(A, B, C, priceRevMax, revMaxTotal, profitAtRevMax, priceProfMax, profitMaxTotal);
    }

    function drawChart(A, B, C, pRev, revMax, piAtRevMax, pProf, piMax) {
        const ctx = document.getElementById('optimizerChart').getContext('2d');
        
        // Determine Range
        const maxP = -A/B; 
        const startP = 0;
        const endP = maxP * 0.8; 

        const steps = 50;
        const stepSize = (endP - startP) / steps;

        let labels = [];
        let revenueData = [];
        let profitData = [];

        for (let i = 0; i <= steps; i++) {
            const p = startP + (i * stepSize);
            const q = A + (B * p);
            if (q < 0) break;

            const rev = p * q;
            const profit = (p - C) * q;

            labels.push(p.toFixed(2));
            revenueData.push(rev);
            profitData.push(profit);
        }

        if (myChart) {
            myChart.destroy();
        }

        myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'Revenue Curve',
                        data: revenueData,
                        borderColor: '#2563eb', // Blue
                        backgroundColor: 'rgba(37, 99, 235, 0.05)',
                        borderWidth: 2,
                        tension: 0.4,
                        pointRadius: 0,
                        pointHoverRadius: 6,
                        fill: true
                    },
                    {
                        label: 'Profit Curve',
                        data: profitData,
                        borderColor: '#990000', // Crimson
                        backgroundColor: 'rgba(153, 0, 0, 0.1)',
                        borderWidth: 3,
                        tension: 0.4,
                        pointRadius: 0,
                        pointHoverRadius: 6,
                        fill: true
                    },
                    // --- OPTIMAL POINTS ---
                    {
                        label: 'Max Revenue',
                        data: [{x: pRev, y: revMax}], 
                        backgroundColor: '#2563eb',
                        borderColor: '#ffffff',
                        borderWidth: 2,
                        pointRadius: 8,
                        type: 'scatter'
                    },
                    {
                        label: 'Max Profit',
                        data: [{x: pProf, y: piMax}], 
                        backgroundColor: '#990000',
                        borderColor: '#ffffff',
                        borderWidth: 2,
                        pointRadius: 8,
                        type: 'scatter'
                    },
                    {
                        label: 'Profit Gap (At Rev Max)',
                        data: [{x: pRev, y: piAtRevMax}], 
                        backgroundColor: '#ffffff',
                        borderColor: '#ef4444', // Red border, white fill
                        borderWidth: 2,
                        pointRadius: 6,
                        type: 'scatter'
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        mode: 'nearest',
                        intersect: false,
                        callbacks: {
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (context.dataset.type === 'scatter') {
                                     // For the points, use x/y directly
                                     return label + ': $' + context.raw.y.toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0});
                                }
                                return label + ': $' + context.parsed.y.toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0});
                            }
                        }
                    },
                    title: { display: false }
                },
                scales: {
                    x: {
                        type: 'linear', // Use linear scale for scatter points to align correctly
                        title: { display: true, text: 'Price ($)' },
                        grid: { display: false },
                        ticks: {
                            callback: function(value) { return '$' + value; }
                        }
                    },
                    y: {
                        title: { display: true, text: 'Dollars ($)' },
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) { return '$' + value.toLocaleString(); }
                        }
                    }
                }
            }
        });
    }
</script>

</div> <!-- end main-content -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script>
    const firebaseConfig = {
        apiKey: "AIzaSyBg3LJDwVIRGWtFZb_mM_CSRJMNCJUta20",
        authDomain: "iu-pricing-tools.firebaseapp.com",
        projectId: "iu-pricing-tools",
        storageBucket: "iu-pricing-tools.firebasestorage.app",
        messagingSenderId: "659335573790",
        appId: "1:659335573790:web:00013a166787efecb3d90f",
        measurementId: "G-NGKNY08XWP"
    };
    firebase.initializeApp(firebaseConfig);
    firebase.auth().onAuthStateChanged(function(user) {
        if (user) {
            document.getElementById('loading-screen').style.display = 'none';
            document.getElementById('main-content').style.display = 'block';
        } else {
            window.location.href = 'login.html';
        }
    });
</script>

</body>
</html>